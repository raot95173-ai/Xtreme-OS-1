name: Xtreme OS 1 - Performance Build

on: [push]

jobs:
  build-and-vnc:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Build Environment
        run: |
          sudo apt-get update
          sudo apt-get install -y qemu-kvm x11vnc xvfb tightvncserver \
          git-core gnupg flex bison build-essential zip curl zlib1g-dev \
          libgl1-mesa-dev libxml2-utils xsltproc unzipbc bc

      - name: Run Optimization & Build Script
        run: |
          chmod +x xtreme_build.sh
          ./xtreme_build.sh

      - name: Start VNC for Testing
        run: |
          # Start a virtual display
          export DISPLAY=:1
          Xvfb :1 -screen 0 1280x720x24 &
          sleep 5
          # Start VNC server (Password: xtreme1)
          x11vnc -display :1 -nopw -listen localhost -xkb -forever &
          echo "VNC Server started on port 5900"
